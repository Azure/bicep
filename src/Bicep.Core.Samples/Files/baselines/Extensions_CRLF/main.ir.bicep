// BEGIN: Parameters
//@[000:4364) ProgramExpression
//@[000:0000) | | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000) | |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000) | |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000) | |     ├─StringLiteralExpression { Value = moduleWithExtsWithAliases-{0} } [UNPARENTED]
//@[000:0000) | |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000) | |       ├─StringLiteralExpression { Value = moduleWithExtsWithAliases } [UNPARENTED]
//@[000:0000) | |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000) | |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]
//@[000:0000) | | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000) | |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000) | |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000) | |     ├─StringLiteralExpression { Value = moduleWithExtsWithoutAliases-{0} } [UNPARENTED]
//@[000:0000) | |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000) | |       ├─StringLiteralExpression { Value = moduleWithExtsWithoutAliases } [UNPARENTED]
//@[000:0000) | |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000) | |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]
//@[000:0000) | | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000) | |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000) | |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000) | |     ├─StringLiteralExpression { Value = moduleExtConfigsFromParams-{0} } [UNPARENTED]
//@[000:0000) | |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000) | |       ├─StringLiteralExpression { Value = moduleExtConfigsFromParams } [UNPARENTED]
//@[000:0000) | |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000) | |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]
//@[000:0000) | | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000) | |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000) | |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000) | |     ├─StringLiteralExpression { Value = moduleExtConfigFromKeyVaultReference-{0} } [UNPARENTED]
//@[000:0000) | |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000) | |       ├─StringLiteralExpression { Value = moduleExtConfigFromKeyVaultReference } [UNPARENTED]
//@[000:0000) | |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000) | |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]
//@[000:0000) | | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000) | |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000) | |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000) | |     ├─StringLiteralExpression { Value = moduleExtConfigFromReferences-{0} } [UNPARENTED]
//@[000:0000) | |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000) | |       ├─StringLiteralExpression { Value = moduleExtConfigFromReferences } [UNPARENTED]
//@[000:0000) | |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000) | |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]
//@[000:0000) | ├─ResourceDependencyExpression [UNPARENTED]
//@[000:0000) | | └─ResourceReferenceExpression [UNPARENTED]
//@[000:0000) | ├─ResourceDependencyExpression [UNPARENTED]
//@[000:0000) | | └─ResourceReferenceExpression [UNPARENTED]
//@[000:0000) | | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000) | |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000) | |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000) | |     ├─StringLiteralExpression { Value = moduleWithExtsUsingFullInheritance-{0} } [UNPARENTED]
//@[000:0000) | |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000) | |       ├─StringLiteralExpression { Value = moduleWithExtsUsingFullInheritance } [UNPARENTED]
//@[000:0000) | |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000) | |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]
//@[000:0000) | | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000) | |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000) | |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000) | |     ├─StringLiteralExpression { Value = moduleWithExtsUsingFullInheritanceTernary1-{0} } [UNPARENTED]
//@[000:0000) | |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000) | |       ├─StringLiteralExpression { Value = moduleWithExtsUsingFullInheritanceTernary1 } [UNPARENTED]
//@[000:0000) | |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000) | |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]
//@[000:0000) | | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000) | |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000) | |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000) | |     ├─StringLiteralExpression { Value = moduleWithExtsUsingPiecemealInheritance-{0} } [UNPARENTED]
//@[000:0000) | |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000) | |       ├─StringLiteralExpression { Value = moduleWithExtsUsingPiecemealInheritance } [UNPARENTED]
//@[000:0000) | |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000) | |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]
//@[000:0000) | | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000) | |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000) | |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000) | |     ├─StringLiteralExpression { Value = moduleExtConfigsConditionalMixed-{0} } [UNPARENTED]
//@[000:0000) | |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000) | |       ├─StringLiteralExpression { Value = moduleExtConfigsConditionalMixed } [UNPARENTED]
//@[000:0000) | |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000) | |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]
//@[000:0000)   | └─ObjectPropertyExpression [UNPARENTED]
//@[000:0000)   |   ├─StringLiteralExpression { Value = name } [UNPARENTED]
//@[000:0000)   |   └─FunctionCallExpression { Name = format } [UNPARENTED]
//@[000:0000)   |     ├─StringLiteralExpression { Value = moduleWithExtsEmpty-{0} } [UNPARENTED]
//@[000:0000)   |     └─FunctionCallExpression { Name = uniqueString } [UNPARENTED]
//@[000:0000)   |       ├─StringLiteralExpression { Value = moduleWithExtsEmpty } [UNPARENTED]
//@[000:0000)   |       └─PropertyAccessExpression { PropertyName = name } [UNPARENTED]
//@[000:0000)   |         └─FunctionCallExpression { Name = deployment } [UNPARENTED]

param strParam1 string
//@[000:0022) ├─DeclaredParameterExpression { Name = strParam1 }
//@[016:0022) | └─AmbientTypeReferenceExpression { Name = string }

@secure()
//@[000:0039) ├─DeclaredParameterExpression { Name = secureStrParam1 }
//@[001:0009) | ├─FunctionCallExpression { Name = secure }
param secureStrParam1 string
//@[022:0028) | └─AmbientTypeReferenceExpression { Name = string }

param boolParam1 bool
//@[000:0021) ├─DeclaredParameterExpression { Name = boolParam1 }
//@[017:0021) | └─AmbientTypeReferenceExpression { Name = bool }

// END: Parameters

// BEGIN: Variables

var strVar1 = 'strVar1Value'
//@[000:0028) ├─DeclaredVariableExpression { Name = strVar1 }
//@[014:0028) | └─StringLiteralExpression { Value = strVar1Value }
var strParamVar1 = strParam1
//@[000:0028) ├─DeclaredVariableExpression { Name = strParamVar1 }
//@[019:0028) | └─ParametersReferenceExpression { Parameter = strParam1 }

// END: Variables

// BEGIN: Extension declarations

extension az
//@[000:0012) ├─ExtensionExpression { Name = az }
extension kubernetes as k8s
//@[000:0027) ├─ExtensionExpression { Name = k8s }
extension 'br:mcr.microsoft.com/bicep/extensions/hasoptionalconfig/v1:1.2.3' as extWithOptionalConfig1
//@[000:0102) ├─ExtensionExpression { Name = extWithOptionalConfig1 }
extension 'br:mcr.microsoft.com/bicep/extensions/hasoptionalconfig/v1:1.2.3' as extWithOptionalConfig2
//@[000:0102) ├─ExtensionExpression { Name = extWithOptionalConfig2 }
extension 'br:mcr.microsoft.com/bicep/extensions/hasoptionalconfig/v1:1.2.3' with {
//@[000:0141) ├─ExtensionExpression { Name = extWithOptionalConfig3 }
//@[082:0115) | └─ObjectExpression
  optionalString: strParam1
//@[002:0027) |   └─ObjectPropertyExpression
//@[002:0016) |     ├─StringLiteralExpression { Value = optionalString }
//@[018:0027) |     └─ParametersReferenceExpression { Parameter = strParam1 }
} as extWithOptionalConfig3
extension 'br:mcr.microsoft.com/bicep/extensions/hassecureconfig/v1:1.2.3' with {
//@[000:0146) ├─ExtensionExpression { Name = extWithSecureStr1 }
//@[080:0125) | └─ObjectExpression
  requiredSecureString: secureStrParam1
//@[002:0039) |   └─ObjectPropertyExpression
//@[002:0022) |     ├─StringLiteralExpression { Value = requiredSecureString }
//@[024:0039) |     └─ParametersReferenceExpression { Parameter = secureStrParam1 }
} as extWithSecureStr1
extension 'br:mcr.microsoft.com/bicep/extensions/hasconfig/v1:1.2.3' with {
//@[000:0132) ├─ExtensionExpression { Name = extWithConfig1 }
//@[074:0114) | └─ObjectExpression
  requiredString: testResource1.id
//@[002:0034) |   └─ObjectPropertyExpression
//@[002:0016) |     ├─StringLiteralExpression { Value = requiredString }
//@[018:0034) |     └─PropertyAccessExpression { PropertyName = id }
//@[018:0031) |       └─ResourceReferenceExpression
} as extWithConfig1
extension 'br:mcr.microsoft.com/bicep/extensions/hasconfig/v1:1.2.3' with {
//@[000:0153) ├─ExtensionExpression { Name = extWithConfig2 }
//@[074:0135) | └─ObjectExpression
  requiredString: boolParam1 ? strParamVar1 : strParam1
//@[002:0055) |   └─ObjectPropertyExpression
//@[002:0016) |     ├─StringLiteralExpression { Value = requiredString }
//@[018:0055) |     └─TernaryExpression
//@[018:0028) |       ├─ParametersReferenceExpression { Parameter = boolParam1 }
//@[031:0043) |       ├─VariableReferenceExpression { Variable = strParamVar1 }
//@[046:0055) |       └─ParametersReferenceExpression { Parameter = strParam1 }
} as extWithConfig2

// END: Extension declarations

// BEGIN: Key vaults

resource kv1 'Microsoft.KeyVault/vaults@2019-09-01' existing = {
//@[000:0082) ├─DeclaredResourceExpression
//@[063:0082) | └─ObjectExpression
  name: 'kv1'
}

resource scopedKv1 'Microsoft.KeyVault/vaults@2019-09-01' existing = {
//@[000:0135) ├─DeclaredResourceExpression
//@[069:0135) | └─ObjectExpression
  name: 'scopedKv1'
  scope: az.resourceGroup('otherGroup')
}

// END: Key vaults

// BEGIN: Test resources

resource testResource1 'az:My.Rp/TestType@2020-01-01' = {
//@[000:0103) ├─DeclaredResourceExpression
//@[056:0103) | └─ObjectExpression
  name: 'testResource1'
  properties: {}
//@[002:0016) |   └─ObjectPropertyExpression
//@[002:0012) |     ├─StringLiteralExpression { Value = properties }
//@[014:0016) |     └─ObjectExpression
}

resource aks 'Microsoft.ContainerService/managedClusters@2024-02-01' = {
//@[000:0138) ├─DeclaredResourceExpression
//@[071:0138) | └─ObjectExpression
  name: 'aksCluster'
  location: az.resourceGroup().location
//@[002:0039) |   └─ObjectPropertyExpression
//@[002:0010) |     ├─StringLiteralExpression { Value = location }
//@[012:0039) |     └─PropertyAccessExpression { PropertyName = location }
//@[012:0030) |       └─FunctionCallExpression { Name = resourceGroup }
}

// END: Test resources

// BEGIN: Extension configs for modules

module moduleWithExtsWithAliases 'child/hasConfigurableExtensionsWithAlias.bicep' = {
//@[000:0192) ├─DeclaredModuleExpression
//@[084:0192) | ├─ObjectExpression
  extensionConfigs: {
//@[020:0102) | └─ObjectExpression
    k8s: {
//@[004:0074) |   └─ObjectPropertyExpression
//@[004:0007) |     ├─StringLiteralExpression { Value = k8s }
//@[009:0074) |     └─ObjectExpression
      kubeConfig: 'kubeConfig2'
//@[006:0031) |       ├─ObjectPropertyExpression
//@[006:0016) |       | ├─StringLiteralExpression { Value = kubeConfig }
//@[018:0031) |       | └─StringLiteralExpression { Value = kubeConfig2 }
      namespace: 'ns2'
//@[006:0022) |       └─ObjectPropertyExpression
//@[006:0015) |         ├─StringLiteralExpression { Value = namespace }
//@[017:0022) |         └─StringLiteralExpression { Value = ns2 }
    }
  }
}

module moduleWithExtsWithoutAliases 'child/hasConfigurableExtensionsWithoutAlias.bicep' = {
//@[000:0181) ├─DeclaredModuleExpression
//@[090:0181) | ├─ObjectExpression
  extensionConfigs: {
//@[020:0085) | └─ObjectExpression
    kubernetes: {
//@[004:0057) |   └─ObjectPropertyExpression
//@[004:0014) |     ├─StringLiteralExpression { Value = kubernetes }
//@[016:0057) |     └─ObjectExpression
      kubeConfig: 'kubeConfig2'
//@[006:0031) |       └─ObjectPropertyExpression
//@[006:0016) |         ├─StringLiteralExpression { Value = kubeConfig }
//@[018:0031) |         └─StringLiteralExpression { Value = kubeConfig2 }
    }
  }
}

module moduleExtConfigsFromParams 'child/hasConfigurableExtensionsWithAlias.bicep' = {
//@[000:0251) ├─DeclaredModuleExpression
//@[085:0251) | ├─ObjectExpression
  extensionConfigs: {
//@[020:0160) | └─ObjectExpression
    k8s: {
//@[004:0132) |   └─ObjectPropertyExpression
//@[004:0007) |     ├─StringLiteralExpression { Value = k8s }
//@[009:0132) |     └─ObjectExpression
      kubeConfig: boolParam1 ? secureStrParam1 : strParam1
//@[006:0058) |       ├─ObjectPropertyExpression
//@[006:0016) |       | ├─StringLiteralExpression { Value = kubeConfig }
//@[018:0058) |       | └─TernaryExpression
//@[018:0028) |       |   ├─ParametersReferenceExpression { Parameter = boolParam1 }
//@[031:0046) |       |   ├─ParametersReferenceExpression { Parameter = secureStrParam1 }
//@[049:0058) |       |   └─ParametersReferenceExpression { Parameter = strParam1 }
      namespace: boolParam1 ? strParam1 : 'falseCond'
//@[006:0053) |       └─ObjectPropertyExpression
//@[006:0015) |         ├─StringLiteralExpression { Value = namespace }
//@[017:0053) |         └─TernaryExpression
//@[017:0027) |           ├─ParametersReferenceExpression { Parameter = boolParam1 }
//@[030:0039) |           ├─ParametersReferenceExpression { Parameter = strParam1 }
//@[042:0053) |           └─StringLiteralExpression { Value = falseCond }
    }
  }
}

module moduleExtConfigFromKeyVaultReference 'child/hasConfigurableExtensionsWithAlias.bicep' = {
//@[000:0221) ├─DeclaredModuleExpression
//@[095:0221) | ├─ObjectExpression
  extensionConfigs: {
//@[020:0120) | └─ObjectExpression
    k8s: {
//@[004:0092) |   └─ObjectPropertyExpression
//@[004:0007) |     ├─StringLiteralExpression { Value = k8s }
//@[009:0092) |     └─ObjectExpression
      kubeConfig: kv1.getSecret('myKubeConfig')
//@[006:0047) |       ├─ObjectPropertyExpression
//@[006:0016) |       | ├─StringLiteralExpression { Value = kubeConfig }
//@[018:0047) |       | └─ResourceFunctionCallExpression { Name = getSecret }
//@[018:0021) |       |   ├─ResourceReferenceExpression
//@[032:0046) |       |   └─StringLiteralExpression { Value = myKubeConfig }
      namespace: strVar1
//@[006:0024) |       └─ObjectPropertyExpression
//@[006:0015) |         ├─StringLiteralExpression { Value = namespace }
//@[017:0024) |         └─VariableReferenceExpression { Variable = strVar1 }
    }
  }
}

module moduleExtConfigFromReferences 'child/hasConfigurableExtensionsWithAlias.bicep' = {
//@[000:0265) ├─DeclaredModuleExpression
//@[088:0265) | ├─ObjectExpression
  extensionConfigs: {
//@[020:0171) | └─ObjectExpression
    k8s: {
//@[004:0143) |   └─ObjectPropertyExpression
//@[004:0007) |     ├─StringLiteralExpression { Value = k8s }
//@[009:0143) |     └─ObjectExpression
      kubeConfig: aks.listClusterAdminCredential().kubeconfigs[0].value
//@[006:0071) |       ├─ObjectPropertyExpression
//@[006:0016) |       | ├─StringLiteralExpression { Value = kubeConfig }
//@[018:0071) |       | └─PropertyAccessExpression { PropertyName = value }
//@[018:0065) |       |   └─ArrayAccessExpression
//@[063:0064) |       |     ├─IntegerLiteralExpression { Value = 0 }
//@[018:0062) |       |     └─PropertyAccessExpression { PropertyName = kubeconfigs }
//@[018:0050) |       |       └─ResourceFunctionCallExpression { Name = listClusterAdminCredential }
//@[018:0021) |       |         └─ResourceReferenceExpression
      namespace: testResource1.properties.namespace
//@[006:0051) |       └─ObjectPropertyExpression
//@[006:0015) |         ├─StringLiteralExpression { Value = namespace }
//@[017:0051) |         └─PropertyAccessExpression { PropertyName = namespace }
//@[017:0041) |           └─PropertyAccessExpression { PropertyName = properties }
//@[017:0030) |             └─ResourceReferenceExpression
    }
  }
}

module moduleWithExtsUsingFullInheritance 'child/hasConfigurableExtensionsWithAlias.bicep' = {
//@[000:0146) ├─DeclaredModuleExpression
//@[093:0146) | ├─ObjectExpression
  extensionConfigs: {
//@[020:0047) | └─ObjectExpression
    k8s: k8s.config
//@[004:0019) |   └─ObjectPropertyExpression
//@[004:0007) |     ├─StringLiteralExpression { Value = k8s }
//@[009:0019) |     └─PropertyAccessExpression { PropertyName = config }
//@[009:0012) |       └─ExtensionReferenceExpression { ExtensionAlias = k8s }
  }
}

module moduleWithExtsUsingFullInheritanceTernary1 'child/hasConfigurableExtensionsWithAlias.bicep' = {
//@[000:0257) ├─DeclaredModuleExpression
//@[101:0257) | ├─ObjectExpression
  extensionConfigs: {
//@[020:0150) | └─ObjectExpression
    k8s: k8s.config
//@[004:0019) |   ├─ObjectPropertyExpression
//@[004:0007) |   | ├─StringLiteralExpression { Value = k8s }
//@[009:0019) |   | └─PropertyAccessExpression { PropertyName = config }
//@[009:0012) |   |   └─ExtensionReferenceExpression { ExtensionAlias = k8s }
    extWithOptionalConfig: boolParam1 ? extWithOptionalConfig1.config : extWithOptionalConfig2.config
//@[004:0101) |   └─ObjectPropertyExpression
//@[004:0025) |     ├─StringLiteralExpression { Value = extWithOptionalConfig }
//@[027:0101) |     └─TernaryExpression
//@[027:0037) |       ├─ParametersReferenceExpression { Parameter = boolParam1 }
//@[040:0069) |       ├─PropertyAccessExpression { PropertyName = config }
//@[040:0062) |       | └─ExtensionReferenceExpression { ExtensionAlias = extWithOptionalConfig1 }
//@[072:0101) |       └─PropertyAccessExpression { PropertyName = config }
//@[072:0094) |         └─ExtensionReferenceExpression { ExtensionAlias = extWithOptionalConfig2 }
  }
}

module moduleWithExtsUsingPiecemealInheritance 'child/hasConfigurableExtensionsWithAlias.bicep' = {
//@[000:0229) ├─DeclaredModuleExpression
//@[098:0229) | ├─ObjectExpression
  extensionConfigs: {
//@[020:0125) | └─ObjectExpression
    k8s: {
//@[004:0097) |   └─ObjectPropertyExpression
//@[004:0007) |     ├─StringLiteralExpression { Value = k8s }
//@[009:0097) |     └─ObjectExpression
      kubeConfig: k8s.config.kubeConfig
//@[006:0039) |       ├─ObjectPropertyExpression
//@[006:0016) |       | ├─StringLiteralExpression { Value = kubeConfig }
//@[018:0039) |       | └─PropertyAccessExpression { PropertyName = kubeConfig }
//@[018:0028) |       |   └─PropertyAccessExpression { PropertyName = config }
//@[018:0021) |       |     └─ExtensionReferenceExpression { ExtensionAlias = k8s }
      namespace: k8s.config.namespace
//@[006:0037) |       └─ObjectPropertyExpression
//@[006:0015) |         ├─StringLiteralExpression { Value = namespace }
//@[017:0037) |         └─PropertyAccessExpression { PropertyName = namespace }
//@[017:0027) |           └─PropertyAccessExpression { PropertyName = config }
//@[017:0020) |             └─ExtensionReferenceExpression { ExtensionAlias = k8s }
    }
  }
}

module moduleWithExtsUsingPiecemealInheritanceLooped 'child/hasConfigurableExtensionsWithAlias.bicep' = [for i in range(0, 4): {
//@[000:0315) ├─DeclaredModuleExpression
//@[104:0315) | ├─ForLoopExpression
//@[114:0125) | | ├─FunctionCallExpression { Name = range }
//@[120:0121) | | | ├─IntegerLiteralExpression { Value = 0 }
//@[123:0124) | | | └─IntegerLiteralExpression { Value = 4 }
//@[127:0314) | | └─ObjectExpression
//@[114:0125) | |         └─FunctionCallExpression { Name = range }
//@[120:0121) | |           ├─IntegerLiteralExpression { Value = 0 }
//@[123:0124) | |           └─IntegerLiteralExpression { Value = 4 }
  name: 'moduleWithExtsPiecemealInheritanceLooped${i}'
//@[002:0054) | |   └─ObjectPropertyExpression
//@[002:0006) | |     ├─StringLiteralExpression { Value = name }
//@[008:0054) | |     └─InterpolatedStringExpression
//@[051:0052) | |       └─ArrayAccessExpression
//@[051:0052) | |         ├─CopyIndexExpression
  extensionConfigs: {
//@[020:0125) | └─ObjectExpression
    k8s: {
//@[004:0097) |   └─ObjectPropertyExpression
//@[004:0007) |     ├─StringLiteralExpression { Value = k8s }
//@[009:0097) |     └─ObjectExpression
      kubeConfig: k8s.config.kubeConfig
//@[006:0039) |       ├─ObjectPropertyExpression
//@[006:0016) |       | ├─StringLiteralExpression { Value = kubeConfig }
//@[018:0039) |       | └─PropertyAccessExpression { PropertyName = kubeConfig }
//@[018:0028) |       |   └─PropertyAccessExpression { PropertyName = config }
//@[018:0021) |       |     └─ExtensionReferenceExpression { ExtensionAlias = k8s }
      namespace: k8s.config.namespace
//@[006:0037) |       └─ObjectPropertyExpression
//@[006:0015) |         ├─StringLiteralExpression { Value = namespace }
//@[017:0037) |         └─PropertyAccessExpression { PropertyName = namespace }
//@[017:0027) |           └─PropertyAccessExpression { PropertyName = config }
//@[017:0020) |             └─ExtensionReferenceExpression { ExtensionAlias = k8s }
    }
  }
}]

module moduleExtConfigsConditionalMixed 'child/hasConfigurableExtensionsWithAlias.bicep' = {
//@[000:0296) ├─DeclaredModuleExpression
//@[091:0296) | ├─ObjectExpression
  extensionConfigs: {
//@[020:0199) | └─ObjectExpression
    k8s: {
//@[004:0171) |   └─ObjectPropertyExpression
//@[004:0007) |     ├─StringLiteralExpression { Value = k8s }
//@[009:0171) |     └─ObjectExpression
      kubeConfig: boolParam1 ? secureStrParam1 : k8s.config.kubeConfig
//@[006:0070) |       ├─ObjectPropertyExpression
//@[006:0016) |       | ├─StringLiteralExpression { Value = kubeConfig }
//@[018:0070) |       | └─TernaryExpression
//@[018:0028) |       |   ├─ParametersReferenceExpression { Parameter = boolParam1 }
//@[031:0046) |       |   ├─ParametersReferenceExpression { Parameter = secureStrParam1 }
//@[049:0070) |       |   └─PropertyAccessExpression { PropertyName = kubeConfig }
//@[049:0059) |       |     └─PropertyAccessExpression { PropertyName = config }
//@[049:0052) |       |       └─ExtensionReferenceExpression { ExtensionAlias = k8s }
      namespace: boolParam1 ? az.resourceGroup().location : k8s.config.namespace
//@[006:0080) |       └─ObjectPropertyExpression
//@[006:0015) |         ├─StringLiteralExpression { Value = namespace }
//@[017:0080) |         └─TernaryExpression
//@[017:0027) |           ├─ParametersReferenceExpression { Parameter = boolParam1 }
//@[030:0057) |           ├─PropertyAccessExpression { PropertyName = location }
//@[030:0048) |           | └─FunctionCallExpression { Name = resourceGroup }
//@[060:0080) |           └─PropertyAccessExpression { PropertyName = namespace }
//@[060:0070) |             └─PropertyAccessExpression { PropertyName = config }
//@[060:0063) |               └─ExtensionReferenceExpression { ExtensionAlias = k8s }
    }
  }
}

module moduleWithExtsEmpty 'child/hasConfigurableExtensionsWithAlias.bicep' = {
//@[000:0162) └─DeclaredModuleExpression
//@[078:0162)   ├─ObjectExpression
  extensionConfigs: {
//@[020:0078)   └─ObjectExpression
    k8s: k8s.config
//@[004:0019)     ├─ObjectPropertyExpression
//@[004:0007)     | ├─StringLiteralExpression { Value = k8s }
//@[009:0019)     | └─PropertyAccessExpression { PropertyName = config }
//@[009:0012)     |   └─ExtensionReferenceExpression { ExtensionAlias = k8s }
    extWithOptionalConfig: {}
//@[004:0029)     └─ObjectPropertyExpression
//@[004:0025)       ├─StringLiteralExpression { Value = extWithOptionalConfig }
//@[027:0029)       └─ObjectExpression
  }
}

// END: Extension configs for modules

