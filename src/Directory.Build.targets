<Project>

  <!--
    We need to use conditional compilation for some platform-specific code in certain cases. 
    The macros declared here represent the platform of the build machine that is compiling the code.
    You are wrong if you use these macros in code that compiles into a multi-platform binary.
    (If we ship one binary for all 3 platforms, there will only be one build machine platform and it won't match the 2 others.)
  -->
  <PropertyGroup Condition=" $(MSBuildProjectExtension) == '.csproj' ">
    <IsWindowsBuild Condition="'$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::Windows)))' == 'true'">true</IsWindowsBuild> 
    <IsOSXBuild Condition="'$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::OSX)))' == 'true'">true</IsOSXBuild> 
    <IsLinuxBuild Condition="'$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::Linux)))' == 'true'">true</IsLinuxBuild>

    <DefineConstants Condition=" $(IsLinuxBuild) == 'true' ">$(DefineConstants);LINUX_BUILD</DefineConstants>
    <DefineConstants Condition=" $(IsOSXBuild) == 'true' ">$(DefineConstants);OSX_BUILD</DefineConstants>
    <DefineConstants Condition=" $(IsWindowsBuild) == 'true' ">$(DefineConstants);WINDOWS_BUILD</DefineConstants>
  </PropertyGroup>

  <!-- Confiugration settings fo the Roslyn FXCop analyzer  -->
  <PropertyGroup>
    <!-- using security rules for now -->
    <CodeAnalysisRuleSet>$(PkgMicrosoft_CodeAnalysis_FxCopAnalyzers)\rulesets\SecurityRulesEnabled.ruleset</CodeAnalysisRuleSet>
  </PropertyGroup>

  <!-- Import the new Roslyn FxCop Analyzer for csproj files -->
  <ItemGroup Condition="'$(MSBuildProjectExtension)' == '.csproj'">
    <PackageReference Include="Microsoft.CodeAnalysis.FxCopAnalyzers" Version="3.3.0">
      <PrivateAssets>All</PrivateAssets>
    </PackageReference>
  </ItemGroup>
</Project>